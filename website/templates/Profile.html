{% if current_user.role == 'Student' %}
    {% extends "StudentHome.html" %}
{% else %}
    {% extends "LibrarianHome.html" %}
{% endif %}

{% block Main %}
<main class="content px-3 py-2" id="profilecontent">
    <div class="container-fluid">
        <!-- Profile Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card bg-gradient shadow-lg border-0 rounded-4 p-4">
                    <div class="card-body d-flex flex-column flex-md-row align-items-center gap-4">
                        <!-- Profile Info Section -->
                        <div class="text-center text-md-start">
                            <h3 class="fw-bold mb-3 text-theme">{{ user.name }}</h3>
                            <p class="text-theme">{{ user.department }} | Year: {{ user.year_of_graduation }}</p>
                            <p class="text-muted">Roll No: {{ user.roll_number }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit Profile Section -->
        <div class="row gy-4">
            <div class="col-12 col-md-6">
                <div class="card glass-card p-4 shadow-lg rounded-4">
                    <div class="card-body">
                        <h5 class="fw-semibold text-theme mt-4 mb-3">Edit Your Details</h5>
                        <form method="POST" enctype="multipart/form-data">
                            <input type="hidden" name="form_type" value="profile_update">
                            <div class="mb-3">
                                <label for="name" class="form-label">Full Name</label>
                                <input type="text" class="form-control glass-input" id="name" name="name" value="{{ user.name }}" required>
                            </div>
                            <div class="mb-3">
                                <label for="phone_number" class="form-label">Phone Number</label>
                                <input type="text" class="form-control glass-input" id="phone_number" name="phone" value="{{ user.phone_number }}">
                            </div>
                            <div class="mb-3">
                                <label for="department" class="form-label">Department</label>
                                <input type="text" class="form-control glass-input" id="department" name="department" value="{{ user.department }}">
                            </div>
                            <div class="mb-3">
                                <label for="year_of_graduation" class="form-label">Year of Graduation</label>
                                <input type="number" class="form-control glass-input" id="year_of_graduation" name="year_of_graduation" value="{{ user.year_of_graduation }}">
                            </div>
                            <div class="mb-3">
                                <label for="profile_picture_url" class="form-label">Profile Picture URL</label>
                                <input type="text" class="form-control glass-input" id="profile_picture_url" name="profile_picture_url" value="{{ user.profile_picture_url }}">
                            </div>
                            <button type="submit" name="update_details" class="btn btn-primary glass-btn">Save Changes</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Change Password Section -->
            <div class="col-12 col-md-6">
                <div class="card glass-card p-4 shadow-lg rounded-4">
                    <div class="card-body">
                        <h5 class="fw-semibold text-theme mt-4 mb-3">Reset Your Password</h5>
                        <form method="POST">
                            <input type="hidden" name="form_type" value="password_reset">
                            <div class="mb-3">
                                <label for="current_password" class="form-label">Current Password</label>
                                <input type="password" class="form-control glass-input" id="current_password" name="current_password" required>
                            </div>
                            <div class="mb-3">
                                <label for="new_password" class="form-label">New Password</label>
                                <input type="password" class="form-control glass-input" id="new_password" name="new_password" required>
                            </div>
                            <div class="mb-3">
                                <label for="confirm_password" class="form-label">Confirm New Password</label>
                                <input type="password" class="form-control glass-input" id="confirm_password" name="confirm_password" required>
                            </div>
                            <button type="submit" name="reset_password" class="btn btn-danger glass-btn">Reset Password</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<style>
    /* Default Light Mode */
.text-theme {
    color: #212529; /* Bootstrap text-dark */
}

/* Dark Mode Override */
html[data-bs-theme="dark"] .text-theme {
    color: #f1f1f1 !important; /* Light text for dark backgrounds */
}

/* Optional: Input contrast fix for dark mode */
html[data-bs-theme="dark"] input,
html[data-bs-theme="dark"] input::placeholder,
html[data-bs-theme="dark"] label {
    color: #f1f1f1;
}

</style>
{% endblock %}

